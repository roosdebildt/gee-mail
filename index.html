<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // for simplicity, store window.geemails in a variable
        var emails = window.geemails;

        var addEmailToTable = function(oneEmail) {
            //make the emails appear in a table
            var tableRow = document.createElement("TR");

            //show sender in a column
            var senderCell = document.createElement("TD");
            senderCell.innerHTML = oneEmail.sender;
            tableRow.appendChild(senderCell);
            
            //show subject in a column
            var subjectCell = document.createElement("TD");
            subjectCell.innerHTML = oneEmail.subject;
            var subjectAppend = tableRow.appendChild(subjectCell);

            //add body
            var bodyRow = document.createElement("TR");
            bodyRow.innerHTML = oneEmail.body;
            bodyRow.classList.add("mailBody");
            bodyRow.style.display = "none";
            subjectAppend.appendChild(bodyRow);

            //trying to target the subjects and make the body of the message show up below the subject. but I don't really know how to target the subject without the  getElementById...
            subjectAppend.addEventListener("click", function(){
                console.log("this works");
                    var bodies = this.getElementsByClassName("mailBody");
                    if(bodies[0].style.display === "none") {
                        bodies[0].style.display = "block";
                    } else {
                        bodies[0].style.display = "none";
                    }
                });

            //show date in a column
            var dateCell = document.createElement("TD");
            dateCell.innerHTML = oneEmail.date;
            tableRow.appendChild(dateCell);


            //create a row for each email
            document.getElementById("inbox").appendChild(tableRow);
        }


        // access data from the emails variable
        for(var i=0; i<emails.length; i++){
        	
            var mail = (emails[i]);

            addEmailToTable(mail);

        }


            // create e-mail counter
            var number = emails.length;
            var counter = document.getElementById("counter");
            var numberText = document.createTextNode(number);
            counter.appendChild(numberText);

            //create interval for new geemails
            var newMail = getNewMessage();
            console.log(newMail);

            var sender = newMail.sender;
            var subject = newMail.subject;
            var date = newMail.date;
            var body = newMail.body;

            var textSender = document.createTextNode(sender);
            var textSubject = document.createTextNode(subject);
            var textDate = document.createTextNode(date);
            var textBody = document.createTextNode(body);

            var inbox = document.getElementById("inbox");
            var createRow = document.createElement("TR");
            var createCell = document.createElement("TD");

            inbox.appendChild(createRow).appendChild(createCell).appendChild(textSender);

            // setInterval(newMail, 500);

      };
    </script>
	</head>
	<body>
		<header>
			<h1>Gee-Mail</h1>
            <h3>You have <span id="counter"></span> gee-mails!</h3>
		</header>
		<div class="container" id="main">
			<table id="inbox">
				<tr class="titles">
					<td>Sender</td>
					<td>Subject</td>
					<td>Date</td>
				</tr>
			</table>
		</div>
	</body>
</html>